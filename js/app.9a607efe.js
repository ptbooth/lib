(function(){"use strict";var e={8677:function(e,t,i){i(8111),i(7588);var n=i(5130),o=i(6768);const a={class:"model-login-require"};function s(e,t,i,n,s,l){const r=(0,o.g2)("App"),d=(0,o.g2)("component__download_gui"),c=(0,o.g2)("component__font-picker"),u=(0,o.g2)("n-carousel-item"),h=(0,o.g2)("n-carousel"),p=(0,o.g2)("n-divider"),g=(0,o.g2)("n-button"),m=(0,o.g2)("n-flex"),_=(0,o.g2)("n-card"),f=(0,o.g2)("n-modal"),b=(0,o.g2)("n-image"),v=(0,o.g2)("n-loading-bar-provider"),y=(0,o.g2)("n-notification-provider"),w=(0,o.g2)("n-message-provider"),k=(0,o.g2)("n-dialog-provider"),x=(0,o.g2)("n-config-provider");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(x,{theme:e.darkTheme,locale:e.viVN,"date-locale":e.dateViVN},{default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[(0,o.bF)(w,null,{default:(0,o.k6)(()=>[(0,o.bF)(y,null,{default:(0,o.k6)(()=>[(0,o.bF)(v,null,{default:(0,o.k6)(()=>[(0,o.bF)(r),(0,o.bF)(d),(0,o.bF)(c),(0,o.bF)(f,{show:e.show_login,"onUpdate:show":t[1]||(t[1]=t=>e.show_login=t)},{default:(0,o.k6)(()=>[(0,o.Lk)("div",a,[(0,o.bF)(h,{style:{height:"180px",overflow:"hidden"},autoplay:""},{default:(0,o.k6)(()=>[(0,o.bF)(u,null,{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.Lk)("img",{src:"https://file.hstatic.net/200000722513/file/tao-anh-bang-ai-1_b6ce6d48bcd54433be01dc947c0d875e_1024x1024.jpg",alt:"image"},null,-1)])]),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.Lk)("img",{src:"https://cdn-media.sforum.vn/storage/app/media/wp-content/uploads/2023/07/hinh-nen-ai-98.jpg",alt:"image"},null,-1)])]),_:1})]),_:1}),(0,o.bF)(_,null,{default:(0,o.k6)(()=>[t[6]||(t[6]=(0,o.Lk)("div",{class:"title"},"Yêu cầu đăng nhập!",-1)),t[7]||(t[7]=(0,o.Lk)("div",{class:"desc",style:{"margin-top":"8px"}},"Hãy đăng nhập để sử dụng những tính năng đặc biệt mà chúng tôi dành riêng cho bạn. ",-1)),(0,o.bF)(p),(0,o.bF)(m,{justify:"center"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{size:"large",ghost:"",type:"primary",onClick:t[0]||(t[0]=t=>e.show_login=!1)},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.eW)(" Bỏ qua ",-1)])]),_:1}),(0,o.bF)(g,{size:"large",type:"primary",onClick:e.$AF.$appFunc.redirectToGoogleAuth},{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.Lk)("img",{style:{"background-color":"white",padding:"2px","border-radius":"50%"},src:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Google_%22G%22_logo.svg/768px-Google_%22G%22_logo.svg.png",width:"24px",alt:""},null,-1),(0,o.eW)("   Đăng nhập ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})])]),_:1},8,["show"]),(0,o.bF)(b,{src:e.image_view.path,style:{display:"none"},ref:"image_view"},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["theme","locale","date-locale"])])}var l=i(7342),r=i(3822);function d(e,t,i,n,a,s){const l=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(l)}i(4114),i(2489),i(116),i(1701);var c=i(8262),u=i(1389),h=i(2484),p=i(1387);var g=i(1241);i(4603),i(7566),i(8721);var m=i(1114);class _{constructor({service_port:e,device_id:t=null}){(0,m.A)(this,"getCameras",()=>this.getJson({url_path:"/cameras"})),(0,m.A)(this,"getLUTs",()=>this.getJson({url_path:"/luts"})),(0,m.A)(this,"uploadLUT",async({file:e,name:t})=>{const i=new URL(this.base_url+"/luts/upload"),n=new FormData;n.append("file",e),n.append("name",t);let o=await fetch(i,{method:"POST",body:n});return await o.json()}),(0,m.A)(this,"applyLUTToImage",async({imageFile:e,lutFile:t})=>{const i=new URL(this.base_url+"/luts/apply?lut_file="+encodeURIComponent(t)),n=new FormData;n.append("image",e),n.append("lut_file",t);let o=await fetch(i,{method:"POST",body:n});return await o.blob()}),(0,m.A)(this,"getConfig",()=>this.getJson({url_path:"/config"})),(0,m.A)(this,"updateConfig",e=>this.postJson({url_path:"/config",body:e})),(0,m.A)(this,"getCameraStreamUrl",(e,t={})=>{const i=new URL(this.base_url+`/cameras/${e}`);return Object.keys(t).forEach(e=>i.searchParams.append(e,t[e])),i.toString()}),(0,m.A)(this,"getCameraSnapshotUrl",(e,t={})=>{const i=new URL(this.base_url+"/cameras/snapshot");return Object.keys(t).forEach(e=>i.searchParams.append(e,t[e])),i.toString()}),(0,m.A)(this,"stopCamera",e=>this.getJson({url_path:"/cameras/stream",method:"DELETE"})),(0,m.A)(this,"remoteTuyaCommand",({action:e})=>this.postJson({url_path:"/tuya",body:{action:e}})),(0,m.A)(this,"getBanks",()=>this.getJson({url_path:"/banks"})),(0,m.A)(this,"getPrinters",()=>this.getJson({url_path:"/printers"})),(0,m.A)(this,"printImage",({printer_id:e,imageFile:t,copies:i=1,printer_setting:n={}})=>{const o=new URL(this.base_url+"/printers/print"),a=new FormData;return a.append("printer_id",e),a.append("image",t),a.append("copies",i),a.append("printer_setting",JSON.stringify(n)),fetch(o,{method:"POST",body:a}).then(e=>e.json())}),(0,m.A)(this,"getPrinterSettings",e=>this.getJson({url_path:`/printers/${e}/settings`})),(0,m.A)(this,"updatePrinterSettings",(e,t)=>this.postJson({url_path:`/printers/${e}/settings`,body:t})),(0,m.A)(this,"uploadImage",async({file:e})=>{const t=new URL(this.base_url+"/uploads"),i=new FormData;i.append("image",e);let n=await fetch(t,{method:"POST",body:i});return await n.json()}),(0,m.A)(this,"getUploadedImage",e=>{const t=new URL(this.base_url+`/uploads/${e}`);return t.toString()}),(0,m.A)(this,"listUploadedImages",()=>this.getJson({url_path:"/uploads"})),(0,m.A)(this,"deleteUploadedImage",e=>{let t=encodeURIComponent(e);return fetch(this.base_url+`/uploads/${t}`,{method:"DELETE"}).then(e=>e.json())}),(0,m.A)(this,"listFrames",()=>this.getJson({url_path:"/frames"})),(0,m.A)(this,"getFrame",e=>this.getJson({url_path:`/frames/${e}`})),(0,m.A)(this,"getFrameImageUrl",e=>{const t=new URL(this.base_url+`/frames/${e}/image`);return t.toString()}),(0,m.A)(this,"createOrUpdateFrame",async({frameData:e,imageFile:t})=>{const i=new URL(this.base_url+"/frames"),n=new FormData;n.append("frame_data",JSON.stringify(e)),n.append("image",t);let o=await fetch(i,{method:"POST",body:n});return await o.json()}),(0,m.A)(this,"deleteFrame",e=>{let t=encodeURIComponent(e);return fetch(this.base_url+`/frames/${t}`,{method:"DELETE"}).then(e=>e.json())}),(0,m.A)(this,"getSoundFileUrl",e=>{const t=new URL(this.base_url+`/sounds/${e}`);return t.toString()}),(0,m.A)(this,"uploadImagesToStorage",async({files:e})=>{const t=new URL(this.base_url+"/storages/upload"),i=new FormData;e.forEach(e=>{i.append("images",e)});let n=await fetch(t,{method:"POST",body:i});return await n.json()}),this.service_port=e,this.base_url=`http://localhost:${this.service_port}/api/v1`,this.device_id=t}async getJson({url_path:e,params:t={},method:i="GET",headers:n={}}){for(;;)try{const o=new URL(this.base_url+e);Object.keys(t).forEach(e=>o.searchParams.append(e,t[e]));let a=await fetch(o,{method:i||"GET",headers:n});return await a.json()}catch(o){await new Promise(e=>setTimeout(e,1e3))}}async postJson({url_path:e,body:t={},headers:i={}}){console.log("base_url",this.base_url,"url_path",e,"body",t);const n=new URL(this.base_url+e);let o=await fetch(n,{method:"POST",headers:{...i||{},"Content-Type":"application/json"},body:JSON.stringify(t)});return await o.json()}async deleteLUT(e){let t=encodeURIComponent(e),i=await fetch(this.base_url+`/luts/${t}`,{method:"DELETE"});return await i.json()}}i(574),i(3579);class f extends _{constructor({server:e,device_id:t,user_token:i}){super({service_port:null,device_id:t}),(0,m.A)(this,"anonymousUploadFile",async({file:e})=>{const t=new URL(this.base_url+"/open-api/anonymous/upload"),i=new FormData;i.append("file",e);let n=await fetch(t,{method:"POST",body:i,headers:this.headers()});return await n.json()}),(0,m.A)(this,"anonymousLibraryCreate",async({image_ids:e})=>this.postJson({url_path:"/open-api/anonymous/library",body:{image_ids:e},headers:this.headers()})),(0,m.A)(this,"anonymousLibraryAppendImage",async({library_id:e,image_id:t,pwd:i})=>this.postJson({url_path:"/open-api/anonymous/library/append",headers:this.headers(),body:{_id:e,image_id:t,pwd:i}})),(0,m.A)(this,"anonymousGetTransactions",async({api_key:e})=>this.getJson({url_path:"/open-api/anonymous/casso-sepay/transactions",headers:this.headers(),params:{api_key:e}})),(0,m.A)(this,"waitingDeviceId",async()=>{for(;;){if(console.log("Waiting for device ID to be ready:",this),this.device_id)return console.log("Device ID is ready:",this.device_id),this.device_id;await new Promise(e=>setTimeout(e,1e3))}}),(0,m.A)(this,"getDeviceConfigUser",async()=>this.device_id?this.getJson({url_path:"/open-api/device-config/user",headers:this.headers()}):null),(0,m.A)(this,"createDeviceConfigUser",async({email:e,password:t,device_id:i})=>this.postJson({url_path:"/open-api/device-config/user",headers:this.headers(),body:{email:e,password:t,device_id:i}})),(0,m.A)(this,"signIn",({uname:e,password:t})=>this.postJson({url_path:"/user/authenticate/sign-in",body:{uname:e,password:t},headers:this.headers()})),(0,m.A)(this,"getUserInfoByToken",async({token:e})=>this.getJson({url_path:"/user/me",params:{token:e},headers:this.headers()})),(0,m.A)(this,"deviceAddOrUpdateDeviceLicense",async({device_id:e,name:t})=>this.postJson({url_path:"/user/devices/licenses",body:{device_id:e,name:t},headers:this.headers()})),(0,m.A)(this,"deviceGetLicenses",async()=>this.getJson({url_path:"/user/devices/licenses",headers:this.headers()})),(0,m.A)(this,"deviceGetLibraries",async({device_id:e,start_date:t,end_date:i,page_index:n,page_size:o})=>this.postJson({url_path:"/user/devices/libraries",body:{device_id:e,start_date:t,end_date:i,page_index:n,page_size:o},headers:this.headers()})),(0,m.A)(this,"deviceGetLibraryDetail",async({library_id:e})=>this.getJson({url_path:"/user/devices/libraries/"+e,headers:this.headers()})),(0,m.A)(this,"deviceDeleteLibrary",async({library_id:e})=>{let t=await fetch(this.base_url+"/user/devices/libraries/"+e,{method:"DELETE",headers:this.headers()});return await t.json()}),(0,m.A)(this,"deviceDeleteSession",async({session_id:e})=>{let t=await fetch(this.base_url+"/user/sessions/"+e,{method:"DELETE",headers:this.headers()});return await t.json()}),(0,m.A)(this,"signOut",async()=>{let e=await fetch(this.base_url+"/user/me/sign-out",{method:"GET",headers:this.headers()});return await e.json()}),e||(e="https://zhikong.ai"),this.server=e,this.base_url=this.server+"/api/v1",this.device_id=t,this.user_token=null,console.log("ServiceFetchServer initialized with server:",e,t,i)}headers(){let e={"x-device-id":this.device_id};return this.user_token&&(e["authorization"]="Bearer "+this.user_token),e}}i(619);var b=i(4232);Boolean;const v={class:"native-input-quantity"};function y(e,t,i,n,a,s){const l=(0,o.g2)("n-input-number");return(0,o.uX)(),(0,o.CE)("div",v,[(0,o.bF)(l,{value:a.scopeValue,"onUpdate:value":t[0]||(t[0]=e=>a.scopeValue=e),step:i.step,size:i.size,parse:a.parse,format:a.format},null,8,["value","step","size","parse","format"])])}var w={name:"component__input-number",props:{modelValue:{type:Number,default:1},max:{type:Number,default:1e4},min:{type:Number,default:1},size:{type:String,default:"medium"},step:{type:Number,default:1}},data(){return{scopeValue:0,parse:e=>{const t=e.replace(/,/g,"").trim();return/^\d+(\.(\d+)?)?$/.test(t)?Number(t):""===t?null:Number.NaN},format:e=>null===e?"":e.toLocaleString("en-US")}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){if(e!==this.modelValue){let t=e;e>this.max&&(t=this.max),e<this.min&&(t=this.min),t!==e&&(this.scopeValue=t),this.$emit("update:modelValue",t)}}},beforeMount(){this.scopeValue=this.modelValue},methods:{sub(){let e=this.scopeValue-1;e<this.min&&(e=this.min),this.scopeValue=e,this.scopeValue!==this.modelValue&&this.$emit("update:modelValue",e)},add(){let e=this.scopeValue+1;e>this.max&&(e=this.max),this.scopeValue=e,this.scopeValue!==this.modelValue&&this.$emit("update:modelValue",e)}}};const k=(0,g.A)(w,[["render",y]]);var x=k;const L={class:(0,b.C4)({"modal-header":!0})},F={class:"flex-3 title",style:{flex:"1"}},C={class:"modal-content"},$={class:"inner-scroll"},A={key:0,class:"modal-footer text-right"},S={key:1,class:"text-right"};function U(e,t,i,n,a,s){const l=(0,o.g2)("Icon"),r=(0,o.g2)("n-flex"),d=(0,o.g2)("n-infinite-scroll"),c=(0,o.g2)("n-button"),u=(0,o.g2)("n-spin");return(0,o.uX)(),(0,o.CE)("div",{class:(0,b.C4)({"model-content__wrapper":!0,"no-padding":i.no_padding,fixed:i.header_fixed}),style:(0,b.Tr)({width:i.width})},[(0,o.Lk)("div",L,[i.is_custom_header?(0,o.RG)(e.$slots,"header",{key:0}):((0,o.uX)(),(0,o.Wv)(r,{key:1,align:"center",justify:"space-between"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",F,(0,b.v_)(i.title),1),(0,o.Lk)("button",{class:"btn-header-color",onClick:t[0]||(t[0]=t=>e.$emit("close"))},[(0,o.bF)(l,{icon:"solar:close-circle-bold",height:"20"})])]),_:1}))]),(0,o.Lk)("div",C,[(0,o.bF)(d,{style:(0,b.Tr)({maxHeight:i.max_height})},{default:(0,o.k6)(()=>[(0,o.Lk)("div",$,[(0,o.RG)(e.$slots,"default")])]),_:3},8,["style"])]),i.hide_footer?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",A,[i.is_custom_footer?(0,o.RG)(e.$slots,"footer",{key:0}):((0,o.uX)(),(0,o.CE)("div",S,[i.show_bottom_back_button?((0,o.uX)(),(0,o.Wv)(c,{key:0,onClick:t[1]||(t[1]=t=>e.$emit("close")),type:"default",round:""},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)(" Đóng ",-1)])]),_:1})):(0,o.Q3)("",!0),t[4]||(t[4]=(0,o.eW)("   ",-1)),i.action_hide?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c,{key:1,round:"",type:i.action_type,disabled:i.action_disabled||i.action_loading,onClick:s.emitAction},{default:(0,o.k6)(()=>[i.action_loading?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.bF)(u,{stroke:"white",size:12}),t[3]||(t[3]=(0,o.eW)("   ",-1))],64)):(0,o.Q3)("",!0),(0,o.eW)(" "+(0,b.v_)(i.action_text),1)]),_:1},8,["type","disabled","onClick"]))]))]))],6)}var V={name:"component__modal-content",components:{Icon:h.In},props:{title:{type:String,default:""},width:{type:String,default:"500px"},no_padding:{type:Boolean,default:!1},hide_header:{type:Boolean,default:!1},is_custom_header:{type:Boolean,default:!1},hide_footer:{type:Boolean,default:!1},is_custom_footer:{type:Boolean,default:!1},action_loading:{type:Boolean,default:!1},action_type:{type:String,default:"primary"},action_text:{type:String,default:"Lưu thông tin"},action_disabled:{type:Boolean,default:!1},action_hide:{type:Boolean,default:!1},max_height:{type:String,default:"calc(100vh - 180px)"},header_fixed:{type:Boolean,default:!1},close_on_click_outside:{type:Boolean,default:!0},show_bottom_back_button:{type:Boolean,default:!0}},data(){return{}},methods:{emitAction(){this.$emit("action")}}};const E=(0,g.A)(V,[["render",U]]);var T=E;i(2462);Boolean;i(8237);const j={style:{"max-width":"calc(100vh - 100px)","min-width":"300px",padding:"32px"}},I={style:{width:"100%"}},P={style:{"text-align":"left"}},O={style:{position:"relative"}},R={class:"custom-arrow"},W=["onClick"],D=["onClick"],N={class:"custom-dots"},X=["onClick"];function B(e,t,i,n,a,s){const l=(0,o.g2)("n-flex"),r=(0,o.g2)("n-skeleton"),d=(0,o.g2)("n-collapse-transition"),c=(0,o.g2)("Icon"),u=(0,o.g2)("n-input"),h=(0,o.g2)("n-button"),p=(0,o.g2)("n-image"),g=(0,o.g2)("n-carousel"),m=(0,o.g2)("n-scrollbar");return(0,o.uX)(),(0,o.Wv)(m,{class:"background-lib"},{default:(0,o.k6)(()=>[(0,o.bF)(l,{justify:"center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",j,[(0,o.bF)(d,{show:a.is_loading},{default:(0,o.k6)(()=>[(0,o.bF)(l,{class:"label"},{default:(0,o.k6)(()=>[...t[0]||(t[0]=[(0,o.eW)(" Đang tải thư viện... ",-1)])]),_:1}),(0,o.Lk)("div",I,[(0,o.bF)(r,{style:{"margin-top":"12px",width:"600px","max-width":"100%",height:"400px","border-radius":"4px"}})])]),_:1},8,["show"]),(0,o.bF)(d,{show:a.image_url.length>0},{default:(0,o.k6)(()=>[(0,o.bF)(l,{class:"label"},{default:(0,o.k6)(()=>[(0,o.bF)(l,{align:"center",direction:"column"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{width:"32px",icon:"solar:calendar-date-bold-duotone"}),(0,o.Lk)("span",null,(0,b.v_)(new Date(1e3*a.info.created_at).toLocaleString()),1)]),_:1})]),_:1}),(0,o.Lk)("div",P,[t[2]||(t[2]=(0,o.Lk)("p",{class:"field-label",style:{color:"white"}},"Liên kết",-1)),(0,o.bF)(l,{align:"center"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{style:{flex:"1"},value:s.shareURL,readonly:""},null,8,["value"]),(0,o.bF)(h,{type:"primary",onClick:s.copyShareUrl},{default:(0,o.k6)(()=>[...t[1]||(t[1]=[(0,o.eW)("Sao chép",-1)])]),_:1},8,["onClick"])]),_:1})]),t[3]||(t[3]=(0,o.Lk)("div",{style:{"margin-top":"16px"}},null,-1)),(0,o.Lk)("div",O,[(0,o.bF)(g,{"show-arrow":"",autoplay:""},{arrow:(0,o.k6)(({prev:e,next:t})=>[(0,o.Lk)("div",R,[(0,o.Lk)("button",{type:"button",class:"custom-arrow--left",onClick:e},[(0,o.bF)(c,{icon:"solar:alt-arrow-left-broken",width:"16px"})],8,W),(0,o.Lk)("button",{type:"button",class:"custom-arrow--right",onClick:t},[(0,o.bF)(c,{icon:"solar:alt-arrow-right-broken",width:"16px"})],8,D)])]),dots:(0,o.k6)(({total:e,currentIndex:t,to:i})=>[(0,o.Lk)("ul",N,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,e=>((0,o.uX)(),(0,o.CE)("li",{key:e,class:(0,b.C4)({["is-active"]:t===e-1}),onClick:t=>i(e-1)},null,10,X))),128))])]),default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.image_url,e=>((0,o.uX)(),(0,o.Wv)(p,{src:e,lazy:"",width:"100%",style:{"border-radius":"8px"},"object-fit":"contain"},null,8,["src"]))),256))]),_:1})])]),_:1},8,["show"])])]),_:1})]),_:1})}var J={name:"lib",data(){return{is_loading:!0,image_url:[],image_blobs:[],info:{},is_failed:!1}},computed:{shareURL(){return window.location.href}},beforeMount(){this.$route.query.t||this.$route.query.r?this.$router.push({path:this.$route.query.t||this.$route.query.r}):this.getInfo()},beforeUnmount(){Array.isArray(this.image_url)&&this.image_url.forEach(e=>{try{URL.revokeObjectURL(e)}catch(t){}})},methods:{copyShareUrl(){navigator.clipboard.writeText(this.shareURL),this.$AF.$msgSuccess("Đã sao chép liên kết vào bộ nhớ tạm!")},async getInfo(){let e="https://zhikong.ai/api/v1/open-api/anonymous/library?"+new URLSearchParams({...this.$route.query||{}}).toString();this.is_loading=!0;let t=await fetch(e);try{let e=await t.json();const i=e?.data?.image_ids||[];this.image_url.length&&this.image_url.forEach(e=>{try{URL.revokeObjectURL(e)}catch(t){}}),this.image_url=[],this.image_blobs=[];const n=i.map(async e=>{const t="https://zhikong.ai/api/v1/cdn/"+encodeURIComponent(e);try{const e=await fetch(t);if(!e.ok)throw new Error(`Fetch failed ${e.status}`);const i=await e.blob(),n=URL.createObjectURL(i);return{blobUrl:n,blob:i}}catch(i){return console.error("Failed to fetch image id",e,i),null}}),o=await Promise.all(n);o.forEach(e=>{e&&(this.image_url.push(e.blobUrl),this.image_blobs.push(e.blob))}),this.info=e?.data||{},this.is_loading=!1}catch(i){console.log("e",i),this.is_loading=!1,this.is_failed=!0}}}};const M=(0,g.A)(J,[["render",B]]);var q=M;const z={class:"management"},G={style:{padding:"16px"}},K={key:0,class:"user-info__container"},H={class:"hello"};function Q(e,t,i,n,a,s){const l=(0,o.g2)("n-button"),r=(0,o.g2)("n-flex"),d=(0,o.g2)("n-data-table"),c=(0,o.g2)("n-tab-pane"),u=(0,o.g2)("n-date-picker"),h=(0,o.g2)("n-select"),p=(0,o.g2)("n-tabs"),g=(0,o.g2)("n-scrollbar"),m=(0,o.g2)("n-input"),_=(0,o.g2)("component__modal-content"),f=(0,o.g2)("n-modal"),v=(0,o.g2)("n-image-group");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",z,[(0,o.bF)(g,{style:{"max-height":"100vh"}},{default:(0,o.k6)(()=>[(0,o.Lk)("div",G,[a.dialog_login.user_info?._id?((0,o.uX)(),(0,o.CE)("div",K,[(0,o.bF)(r,{align:"end"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",H,[t[14]||(t[14]=(0,o.eW)("Xin chào,",-1)),t[15]||(t[15]=(0,o.Lk)("br",null,null,-1)),t[16]||(t[16]=(0,o.eW)()),(0,o.Lk)("span",null,(0,b.v_)(a.dialog_login.user_info?.uname),1)]),(0,o.bF)(l,{size:"tiny",round:"",tertiary:"",onClick:s.trySignOut},{default:(0,o.k6)(()=>[...t[17]||(t[17]=[(0,o.eW)(" Đăng xuất ",-1)])]),_:1},8,["onClick"])]),_:1})])):((0,o.uX)(),(0,o.Wv)(r,{key:1,justify:"start",style:{padding:"12px 0"}},{default:(0,o.k6)(()=>[(0,o.bF)(l,{onClick:t[0]||(t[0]=e=>a.dialog_login.show=!0)},{default:(0,o.k6)(()=>[...t[18]||(t[18]=[(0,o.eW)("Đăng nhập",-1)])]),_:1})]),_:1})),(0,o.bF)(p,{type:"card"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{name:"1",label:"Thiết bị & Bản quyền"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{justify:"space-between",align:"center",style:{"margin-top":"16px"}},{default:(0,o.k6)(()=>[(0,o.bF)(l,{tertiary:"",loading:a.device.loading,onClick:s.getDeviceList},{default:(0,o.k6)(()=>[...t[19]||(t[19]=[(0,o.eW)(" Tải lại ",-1)])]),_:1},8,["loading","onClick"]),(0,o.bF)(l,{type:"success",tertiary:"",onClick:t[1]||(t[1]=e=>a.dialog_edit_device.show=!0)},{default:(0,o.k6)(()=>[...t[20]||(t[20]=[(0,o.eW)(" Thêm thiết bị ",-1)])]),_:1})]),_:1}),(0,o.bF)(d,{"scroll-x":1200,style:{"margin-top":"12px"},data:a.device.list,columns:a.device.columns},null,8,["data","columns"])]),_:1}),(0,o.bF)(c,{name:"2",label:"Thư viện ảnh"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{style:{"margin-top":"16px"}},{default:(0,o.k6)(()=>[(0,o.bF)(u,{type:"daterange",value:a.lib.filter.time_range,"onUpdate:value":t[2]||(t[2]=e=>a.lib.filter.time_range=e),style:{width:"100%",flex:"1"}},null,8,["value"]),(0,o.bF)(h,{style:{flex:"1"},value:a.lib.filter.device_id,"onUpdate:value":t[3]||(t[3]=e=>a.lib.filter.device_id=e),filterable:"",options:[{label:"Tất cả thiết bị",value:""},...a.device.list.map(e=>({label:e.name+" ("+e.device_id+")",value:e.device_id}))]},null,8,["value","options"])]),_:1}),(0,o.bF)(d,{"scroll-x":1200,style:{"margin-top":"12px"},data:a.lib.list,columns:a.lib.columns},null,8,["data","columns"])]),_:1})]),_:1})])]),_:1})]),(0,o.bF)(f,{show:a.dialog_login.show,"onUpdate:show":t[7]||(t[7]=e=>a.dialog_login.show=e),"close-on-esc":!1,"close-focusable":!1},{default:(0,o.k6)(()=>[(0,o.bF)(_,{width:"400px",title:"Đăng nhập",hide_footer:"",onClose:t[6]||(t[6]=e=>a.dialog_login.show=!1),close_on_click_outside:!1},{default:(0,o.k6)(()=>[t[22]||(t[22]=(0,o.Lk)("p",{class:"field-label"},"Tải khoản / Email",-1)),(0,o.bF)(m,{value:a.dialog_login.form.uname,"onUpdate:value":t[4]||(t[4]=e=>a.dialog_login.form.uname=e),ref:"input_login_uname",placeholder:"Nhập tài khoản hoặc email"},null,8,["value"]),t[23]||(t[23]=(0,o.Lk)("p",{class:"field-label",style:{"margin-top":"12px"}},"Mật khẩu ",-1)),(0,o.bF)(m,{type:"password",ref:"input_login_password",value:a.dialog_login.form.password,"onUpdate:value":t[5]||(t[5]=e=>a.dialog_login.form.password=e),placeholder:"Nhập mật khẩu"},null,8,["value"]),(0,o.bF)(r,{justify:"end",style:{"margin-top":"24px"}},{default:(0,o.k6)(()=>[(0,o.bF)(l,{type:"primary",onClick:s.trySignIn,loading:a.dialog_login.loading},{default:(0,o.k6)(()=>[...t[21]||(t[21]=[(0,o.eW)("Đăng nhập ",-1)])]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["show"]),(0,o.bF)(f,{show:a.dialog_edit_device.show,"onUpdate:show":t[11]||(t[11]=e=>a.dialog_edit_device.show=e)},{default:(0,o.k6)(()=>[(0,o.bF)(_,{title:a.dialog_edit_device.form._id?"Sửa thiết bị":"Thêm thiết bị",width:"460px",onClose:t[10]||(t[10]=e=>a.dialog_edit_device.show=!1)},{default:(0,o.k6)(()=>[t[24]||(t[24]=(0,o.Lk)("p",{class:"field-label"},"Tên thiết bị",-1)),(0,o.bF)(m,{value:a.dialog_edit_device.form.name,"onUpdate:value":t[8]||(t[8]=e=>a.dialog_edit_device.form.name=e),placeholder:"Nhập tên thiết bị"},null,8,["value"]),t[25]||(t[25]=(0,o.Lk)("p",{class:"field-label",style:{"margin-top":"12px"}},"Mã thiết bị ",-1)),(0,o.bF)(m,{disabled:a.dialog_edit_device.form._id,value:a.dialog_edit_device.form.device_id,"onUpdate:value":t[9]||(t[9]=e=>a.dialog_edit_device.form.device_id=e),placeholder:"Nhập mã thiết bị"},null,8,["disabled","value"])]),_:1},8,["title"])]),_:1},8,["show"]),(0,o.bF)(v,{show:a.lib.view.show,"onUpdate:show":t[12]||(t[12]=e=>a.lib.view.show=e),current:a.lib.view.current_index,"onUpdate:current":t[13]||(t[13]=e=>a.lib.view.current_index=e),"src-list":[...a.lib.view.image_url]},null,8,["show","current","src-list"])],64)}var Y={name:"page__management",components:{Component__modalContent:T},data(){return{dialog_login:{show:!1,loading:!1,user_info:null,form:{uname:"",password:""}},device:{loading:!1,list:[],columns:[{title:"Tên thiết bị",key:"name"},{title:"Mã thiết bị",key:"device_id"},{title:"Lần cuối hoạt động",key:"last_active_at",render(e){return e.last_active_at?new Date(1e3*e.last_active_at).toLocaleString():"Chưa kích hoạt"}},{title:"Ngày hết hạn",key:"license_to",align:"right",render(e){return e.license_to?new Date(1e3*e.license_to).toLocaleString():"Không giới hạn"}}]},dialog_edit_device:{show:!1,loading:!1,form:{name:"",device_id:""},base_form:{}},lib:{loading:!1,list:[],columns:[{title:"Mật khẩu",key:"pwd"},{title:"Số ảnh",key:"image_ids",render(e){return(e.image_ids||[]).length}},{title:"Ngày tạo",key:"created_at",render(e){return e.created_at?new Date(1e3*e.created_at).toLocaleString():"N/A"}},{title:"Hành động",key:"actions",align:"right",render:e=>de([{text:"Xóa",onClick:()=>this.tryDeleteLibrary(e)},{text:"Đường dẫn",onClick:()=>this.copyLibLink(e)},{text:"Xem",type:"success",onClick:()=>this.showLibImages(e)}])}],filter:{time_range:[new Date,new Date],page_index:0,page_size:1e3,device_id:""},view:{image_url:[],current_index:0,show:!1}}}},watch:{"dialog_edit_device.show"(e){!1===e&&(this.dialog_edit_device.form=this.unbindObj(this.dialog_edit_device.base_form))},"lib.filter.time_range"(e){this.getLibList()},"lib.filter.device_id"(e){this.getLibList()}},beforeMount(){this.dialog_edit_device.base_form=this.unbindObj(this.dialog_edit_device.form),this.restoreUserSession()},methods:{async tryDeleteLibrary(e){if(await this.$AF.$qConfirm("Bạn có chắc muốn xóa thư viện ảnh này không?")){let t=await this.$fetch.server.deviceDeleteLibrary({library_id:e._id});0===t?.error?(this.$AF.$msgSuccess("Xóa thư viện ảnh thành công"),await this.getLibList()):this.$AF.$msgWarning(t?.message||"Xóa thư viện ảnh thất bại")}},copyLibLink(e){let t=`https://ptbooth.github.io/lib/?_id=${e._id}&pwd=${e.pwd}`;navigator.clipboard.writeText(t),this.$AF.$msgSuccess("Đã sao chép đường dẫn thư viện ảnh vào clipboard")},async showLibImages(e){this.$AF.$msgSuccess("Đang tải ảnh từ thư viện...");let t=e.image_ids||[];const i=t.map(async e=>{const t="https://zhikong.ai/api/v1/cdn/"+encodeURIComponent(e);try{const e=await fetch(t);if(!e.ok)throw new Error(`Fetch failed ${e.status}`);const i=await e.blob(),n=URL.createObjectURL(i);return{blobUrl:n,blob:i}}catch(i){return console.error("Failed to fetch image id",e,i),null}}),n=await Promise.all(i);this.lib.view.image_url=[],n.forEach(e=>{e&&this.lib.view.image_url.push(e.blobUrl)}),console.log("this.lib.view.image_url",this.lib.view.image_url),this.lib.view.current_index=0,this.lib.view.show=!0},getAll(){this.getDeviceList(),this.getLibList()},async getDeviceList(){await this.loginCheckingAndNext({next:async()=>{this.device.loading=!0;let e=await this.$fetch.server.deviceGetLicenses();0===e?.error&&(this.device.list=e.data||[]),this.device.loading=!1}})},async getLibList(){await this.loginCheckingAndNext({next:async()=>{this.lib.loading=!0;let e=this.unbindObj(this.lib.filter);e.start_date=this.timestamp(this.lib.filter.time_range[0]),e.end_date=this.timestamp(this.lib.filter.time_range[1]),""===e.device_id&&delete e.device_id;let t=await this.$fetch.server.deviceGetLibraries(e);0===t?.error&&(this.lib.list=t.data||[]),this.lib.loading=!1}})},async trySignOut(){await this.$AF.$qConfirm("Bạn có chắc muốn đăng xuất khỏi tài khoản này không?")&&(await this.$fetch.server.signOut(),this.dialog_login.user_info=null,localStorage.removeItem("PTB_TOKEN"),this.$AF.$msgSuccess("Đã đăng xuất thành công"))},async trySignIn(){if(!1===/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.dialog_login.form.uname))return this.$AF.$msgWarning("Vui lòng nhập đúng định dạng email"),void this.$refs.input_login_uname.focus();if(this.dialog_login.form.password.length<6)return this.$AF.$msgWarning("Mật khẩu phải có độ dài lớn hơn 6 ký tự"),void this.$refs.input_login_password.focus();this.dialog_login.loading=!0;let e=await this.$fetch.server.signIn(this.dialog_login.form);e?.error?this.$AF.$msgWarning(e.message||"Đăng nhập thất bại"):(this.$fetch.server.user_token=e.data.token,this.dialog_login.user_info=e.data,localStorage.setItem("PTB_TOKEN",e.data.token),this.dialog_login.show=!1,this.getAll()),this.dialog_login.loading=!1},async loginCheckingAndNext({next:e}){this.dialog_login.user_info&&e&&e()},async restoreUserSession(){try{let e=localStorage.getItem("PTB_TOKEN");if(e.toString().length>10){let t=await this.$fetch.server.getUserInfoByToken({token:e});if(0===t?.error)return this.dialog_login.user_info={...t.data,token:e},this.$fetch.server.user_token=e,this.getAll(),0}}catch(e){}this.dialog_login.user_info||(this.dialog_login.show=!0)}}};const Z=(0,g.A)(Y,[["render",Q]]);var ee=Z;const te=[{path:"/",name:"lib",component:q},{path:"/lib",name:"lib",component:q},{path:"/management",name:"management",component:ee}],ie=(0,p.aE)({history:(0,p.LA)("/lib/"),routes:te});var ne=ie;const oe="https://invoice-lite.ipos.vn/api",ae={IMAGE:"image/png,image/jpeg,image/jpg,image/webp",VIDEO:"video/mp4,video/webm,video/m4v,video/avi,video/mpeg",AUDIO:"audio/mp3,audio/mpeg,audio/wav",ANY:"*"},se=({save_subject:e=!1,download:t=!1,create_image:i=!1,increase_quality:n=!1,remove_subject_background:o=!1,create_video:a=!1,on_save_subject:s=()=>null,on_download:l=()=>null,on_create_image:r=()=>null,on_increase_quality:d=()=>null,on_remove_subject_background:c=()=>null,on_create_video:u=()=>null})=>[...e?[{label:"Lưu đối tượng",icon:"solar:gallery-wide-linear",onClick:s}]:[],...t?[{label:"Tải xuống",icon:"solar:cloud-download-linear",onClick:l}]:[],...i?[{label:"Tạo ảnh",icon:"solar:gallery-add-broken",onClick:r}]:[],...n?[{label:"Tăng chất lượng",icon:"solar:high-quality-broken",onClick:d}]:[],...o?[{label:"Xoá nền đối tượng",icon:"solar:file-remove-broken",onClick:c}]:[],...a?[{label:"Tạo Video",icon:"solar:videocamera-add-broken",onClick:u}]:[]],le={initialize:"KH nhập thông tin",payment:"KH đang thanh toán",pending:"Khởi tạo iPOS Invoice",signature:"Đang tạo CKS",tax_registration:"Gửi tờ khai CQT",pos_connect:"Kết nối điểm bán hàng",completed:"Đang sử dụng",failed:"Thanh lý, huỷ bỏ"};Object.keys(le).map(e=>({value:e,label:le[e]}));var re={$ntf:{},$loading:{},$msg:{},$question:{},$picker:({min:e,max:t,blob:i})=>new Promise(e=>{}),$cropper:()=>{},$appFunc:{getImageBase64:async e=>{const t=await fetch(e),i=await t.blob();return new Promise((e,t)=>{const n=new FileReader;n.readAsDataURL(i),n.onloadend=()=>e(n.result),n.onerror=t})},getImageBase64Loading:e=>new Promise(async t=>{re.$loading.start();let i=await re.$appFunc.getImageBase64(ce(e));re.$loading.finish(),i&&t(i)}),registrationProfileCreateOrUpdate:({base:e,callback:t})=>{}},$startDownload:({file_url:e,file_name:t,file_ex:i="png",download_callback:n,mime_type:o,is_get_blob_only:a=!1})=>{},$loginRequire:()=>{},$creationView:({creation_id:e,creation:t})=>null,$imageView:e=>({}),videoCutter:({videoUrl:e})=>new Promise(e=>{}),$fontPicker:({defaultFont:e})=>new Promise(e=>{}),$qConfirm:e=>new Promise(t=>{re.$question.info({title:"Xác nhận",content:e||"Bạn có chắc chắc chắn không?",positiveText:"Chắc chắn",negativeText:"Không",draggable:!0,showIcon:!1,onPositiveClick:()=>{t(!0)},onNegativeClick:()=>{t(null)},positiveButtonProps:{type:"primary"}})}),$handleError:e=>new Promise(t=>{if(e){let t=e;"object"===typeof e&&(t=JSON.stringify(e)),re.$msg.error({title:"Lỗi",content:t})}else t()}),$handleResponseError:async e=>new Promise(t=>{if(0===e?.error)t();else{let t=e.message||"Lỗi không xác định";"system_error"===t&&(t="Máy chủ gặp sự cố"),re.$msg.error(t)}}),$lockErrorResponse:async({error:e,result:t})=>new Promise(i=>{(async()=>{await re.$handleError(e),await re.$handleResponseError(t),i()})()}),$msgSuccess:e=>{let t=e&&e.message||e||"Success";re.$msg.success(t)},$msgWarning:e=>{let t=e&&e.message||e||"Warning";re.$msg.warning(t)},$uploadFileThread:({ref_list:e,on_upload_error:t})=>new Promise(i=>{(async()=>{let n=await Promise.all([...e.filter(e=>e.upload).map(e=>e.upload())]),o=n.find(e=>"string"!==typeof e&&(e.error||e.result.error));o?t&&t(o):i()})()}),$sortData:e=>(e.length>0&&"number"===typeof e[0].sort&&(e=e.sort((e,t)=>e.sort-t.sort)),e),$filter:{$currency:e=>(e||0).toLocaleString("vi-VN")}};const de=e=>(0,o.h)(c.A,{wrap:!1,justify:"end"},e.map(e=>(0,o.h)(u.Ay,{size:"small",onClick:()=>e.onClick(),ghost:e.ghost||!1,type:e.type||"default"},{default:()=>e.text}))),ce=e=>e?(e=e.toString(),e.startsWith("http")||e.startsWith("blob")||e.startsWith("data")?e:oe+"/v1/cdn/"+encodeURIComponent(e)):e,ue={save_subject:async({url:e,b64:t})=>{e&&!t&&(t=await re.$appFunc.getImageBase64Loading(e)),e&&t&&re.$appFunc.subjectManagerSave({url:e,b64:t})},download:({url:e})=>{re.$startDownload({file_url:e,file_name:"Downloading"})},redirect:({url:e,path:t})=>ne.push(`${t}?image=${encodeURIComponent(e)}`),create_image:({url:e})=>ue.redirect({url:e,path:"/creation/image"}),image_quality:({url:e})=>ue.redirect({url:e,path:"/creation/image/quality"}),image_remove_bg:({url:e})=>ue.redirect({url:e,path:"/creation/image/rm-bg"}),create_video:({url:e})=>ue.redirect({url:e,path:"/creation/video/from-image"})};var he=i(7387),pe=i(4185),ge=i(6909),me=i(4751),_e={name:"App",data(){return{}},computed:{},beforeMount(){re.$msg=(0,he.J)(),re.$ntf=(0,pe.h)(),re.$question=(0,ge.s)(),re.$loading=(0,me.z)()},mounted(){window.addEventListener("keyup",e=>{"F9"===e.key&&e.ctrlKey&&this.$router.push({path:"/setting",query:this.$route.query||{}})})},beforeDestroy(){},methods:{}};const fe=(0,g.A)(_e,[["render",d]]);var be=fe;const ve={class:"download-gui__container"},ye={class:"flex-1"},we={class:"file-name"},ke={class:"file-path"};function xe(e,t,i,n,a,s){const l=(0,o.g2)("n-progress"),r=(0,o.g2)("n-flex"),d=(0,o.g2)("n-scrollbar"),c=(0,o.g2)("n-popover");return(0,o.uX)(),(0,o.Wv)(c,{show:a.download_list.length>0,trigger:"manual",placement:"top-start"},{trigger:(0,o.k6)(()=>[...t[0]||(t[0]=[(0,o.Lk)("div",{class:"download-gui"},null,-1)])]),default:(0,o.k6)(()=>[(0,o.Lk)("div",ve,[(0,o.bF)(d,{style:{"max-height":"200px","min-height":"40px"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.download_list,i=>((0,o.uX)(),(0,o.Wv)(r,{key:i.file_url,class:"file-item",align:"center"},{default:(0,o.k6)(()=>[(0,o.bF)(l,{type:"circle",percentage:i.percent,style:{width:"20px"},color:["red","grey","blue","green"][i.status+1]},{default:(0,o.k6)(()=>[...t[1]||(t[1]=[])]),_:1},8,["percentage","color"]),(0,o.Lk)("div",ye,[(0,o.Lk)("div",we,(0,b.v_)(i.file_name),1),(0,o.Lk)("div",ke,(0,b.v_)(e.srcCDN(i.file_url).substr(0,36))+"...",1)])]),_:2},1024))),128))]),_:1})])]),_:1},8,["show"])}var Le={name:"component__download_gui",data(){return{show:!0,download_list:[],interval_check_download:null,maximum_thread:4}},beforeMount(){this.$AF.$startDownload=({file_url:e,file_name:t,file_ex:i="png",download_callback:n,mime_type:o,is_get_blob_only:a=!1})=>{this.download_list.map(e=>e.file_url);this.download_list.push({file_name:t,file_url:e,file_ex:i,start:new Date,status:0,percent:0,download_callback:n,mime_type:o,is_get_blob_only:a})},this.interval_check_download=setInterval(()=>{let e=this.download_list.filter(e=>0===e.status);if(e>this.maximum_thread)return;let t=e.find(e=>0===e.status);t&&this.downloadFile(t)},1e3)},methods:{async downloadFile(e){e.status=1;try{let t=this.srcCDN(e.file_url);const i=await fetch(t),n=i.body.getReader(),o=+i.headers.get("Content-Length");let a="";if(!a)for(;!a;){a=t.endsWith(".mp4")||t.endsWith(".m4v")?"video/mp4":t.endsWith(".mp3")?"audio/mpeg":t.endsWith(".wav")?"audio/wav":t.endsWith(".ogg")?"audio/ogg":t.endsWith(".webm")?"video/webm":t.endsWith(".gif")?"image/gif":t.endsWith(".png")?"image/png":t.endsWith(".jpg")||t.endsWith(".jpeg")?"image/jpeg":t.endsWith(".json")?"application/json":t.endsWith(".doc")?"application/msword":t.endsWith(".docx")?"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t.endsWith(".xls")?"application/vnd.ms-excel":t.endsWith(".xlsx")?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":t.endsWith(".pdf")?"application/pdf":t.endsWith(".zip")?"application/zip":t.endsWith(".rar")?"application/x-rar-compressed":"application/octet-stream";break}let s=0,l=[];for(;;){const{done:t,value:i}=await n.read();if(t)break;l.push(i),s+=i.length,e.percent=Math.floor(s/o*100)}let r=new Blob(l,{type:a,name:e.file_name||"downloaded_file"});r.name=e.file_name||"downloaded_file";const d=URL.createObjectURL(r);if(e.is_get_blob_only)e.download_callback&&e.download_callback(r),e.status=2;else{const i=document.createElement("a");i.href=d;let n=e.file_name||t.split("/").pop().split("?")[0];if(!n||!n.includes(".")){const t=e.file_ex||(a?a.split("/")[1]:"bin");n=`iPOSInvoice-file.${t}`}i.download=n,document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(d),e.status=2}}catch(i){e.status=-1}let t=this.download_list.map(e=>e.file_url).indexOf(e.file_url);this.download_list.splice(t,1)}}};const Fe=(0,g.A)(Le,[["render",xe]]);var Ce=Fe;const $e={class:"font-picker"},Ae=["onClick"],Se=["src"];function Ue(e,t,i,n,a,s){const l=(0,o.g2)("Icon"),r=(0,o.g2)("n-input"),d=(0,o.g2)("n-flex"),c=(0,o.g2)("component_empty"),u=(0,o.g2)("n-col"),h=(0,o.g2)("n-row"),p=(0,o.g2)("n-scrollbar"),g=(0,o.g2)("component__modal-content"),m=(0,o.g2)("n-modal");return(0,o.uX)(),(0,o.CE)("div",$e,[(0,o.bF)(m,{show:a.show,"onUpdate:show":t[2]||(t[2]=e=>a.show=e)},{default:(0,o.k6)(()=>[(0,o.bF)(g,{title:"Chọn Font chữ",width:"600px",onClose:t[1]||(t[1]=e=>a.show=!1),action_text:`Chọn (${a.selected_font})`,onAction:s.confirmSelectFont},{default:(0,o.k6)(()=>[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(r,{style:{"max-width":"300px"},placeholder:"Tìm kiếm font chữ ...",value:a.keyword,"onUpdate:value":t[0]||(t[0]=e=>a.keyword=e)},{prefix:(0,o.k6)(()=>[(0,o.bF)(l,{icon:"solar:magnifer-outline"})]),_:1},8,["value"])]),_:1}),(0,o.bF)(p,{style:{"margin-top":"12px","max-height":"calc(100vh - 300px)","min-height":"100px"}},{default:(0,o.k6)(()=>[0===s._filtered_font_list.length?((0,o.uX)(),(0,o.Wv)(c,{key:0})):(0,o.Q3)("",!0),(0,o.bF)(h,{gutter:12},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s._filtered_font_list,e=>((0,o.uX)(),(0,o.Wv)(u,{span:8},{default:(0,o.k6)(()=>[(0,o.Lk)("div",{onClick:t=>a.selected_font=e.name,class:(0,b.C4)({"font-item":!0,active:a.selected_font===e.name})},[(0,o.Lk)("div",null,[(0,o.Lk)("img",{src:s.getImage(e),alt:""},null,8,Se)]),(0,o.bF)(d,{justify:"center",class:"font-item__name"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,b.v_)(e.name),1)]),_:2},1024)],10,Ae)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1},8,["action_text","onAction"])]),_:1},8,["show"])])}const Ve={class:"empty"};function Ee(e,t,i,n,a,s){const l=(0,o.g2)("n-flex");return(0,o.uX)(),(0,o.CE)("div",Ve,[(0,o.bF)(l,{justify:"center"},{default:(0,o.k6)(()=>[...t[0]||(t[0]=[(0,o.Lk)("img",{src:"/img/empty.svg",alt:"",style:{width:"100%","max-width":"140px",opacity:".4"}},null,-1)])]),_:1}),(0,o.bF)(l,{justify:"center",style:{"font-size":"12px"}},{default:(0,o.k6)(()=>[(0,o.Lk)("div",null,(0,b.v_)(i.description),1)]),_:1})])}var Te={name:"component_empty",props:{description:{type:String,default:"Chưa có dữ liệu!"}},data(){return{}}};const je=(0,g.A)(Te,[["render",Ee]]);var Ie=je,Pe={name:"component__font-picker",components:{Component_empty:Ie,Component__modalContent:T},data(){return{font_list:[],selected_font:"",show:!1,keyword:"",callback:null,SERVER_URL:oe}},computed:{_filtered_font_list(){let e=this.keyword.toLowerCase().trim();return this.font_list.filter(t=>t.keyword.includes(e))}},watch:{show:function(e){e&&0===this.font_list.length&&this.getFontList()}},beforeMount(){this.$AF.$fontPicker=({defaultFont:e})=>new Promise(t=>{this.selected_font=e||this.selected_font,this.callback=t,this.show=!0})},methods:{confirmSelectFont(){this.callback&&this.callback(this.selected_font),this.show=!1},getImage(e){return[oe.replace("/api",""),"font_samples",e.image].join("/")},async getFontList(){let e=await(await this.$fetch.base.getFonts()).json();this.font_list=(e||[]).map(e=>({...e,keyword:e.name.toLowerCase()}))}}};const Oe=(0,g.A)(Pe,[["render",Ue]]);var Re=Oe,We=i(5888),De=(0,o.pM)({name:"Provider",components:{Component__fontPicker:Re,Component__download_gui:Ce,App:be},data(){return{darkTheme:We.a,viVN:l.A,dateViVN:r.A,theme_config:{fontSize:"13px",common:{primaryColor:"#2215b9",primaryColorHover:"#594fc5",primaryColorPressed:"#5d34af",primaryColorSuppl:"#0f31da",borderRadius:"5px",borderColor:"rgba(235,235,235,1)",borderWidth:0,backgroundColor:"#f5f5f5",fontSize:"13px",border:0,fontWeightStrong:"400",lineHeight:1.3,inputBackgroundColor:"red"},Select:{backgroundColor:"red",peers:{InternalSelection:{textColor:"#FF0000",backgroundColor:"red"}}}},show_login:!1,image_view:{path:""}}},beforeMount(){this.$AF.$imageView=e=>{this.image_view.path=e,this.$nextTick(()=>{this.$refs.image_view.click()})}},methods:{}});const Ne=(0,g.A)(De,[["render",s]]);var Xe=Ne,Be=i(4458);(0,Be.k)("/lib/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var Je=i(782),Me=(0,Je.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}}),qe=i(6587),ze=i.n(qe);const Ge={class:"file-picker"},Ke=["id","accept","multiple"];function He(e,t,i,n,a,s){return(0,o.uX)(),(0,o.CE)("div",Ge,[(0,o.Lk)("input",{type:"file",id:a.id,ref:"file_picker",accept:a.accept,multiple:a.max>1,onChange:t[0]||(t[0]=(...e)=>s.handleFileChange&&s.handleFileChange(...e))},null,40,Ke)])}var Qe={name:"component__file-picker",data(){return{accept:ae.IMAGE,max:1,resolve:null,file_picker:(0,o.rk)("file_picker"),id:"",listener:null,blob:!0}},beforeMount(){this.id="file_picker_"+this.generateCode(24),re.$picker=({accept:e,max:t,blob:i=!0})=>new Promise(n=>{this.max=t||1,this.accept=e||ae.IMAGE,this.resolve=n,this.blob=i,this.$nextTick(()=>{this.file_picker.click()})})},mounted(){},beforeDestroy(){},methods:{handleFileChange:function(e){let t=e.clipboardData||{},i=t.files||t.items,n=(e.target||{}).files||(e.dataTransfer||{}).files||i||[],o=[];for(let a=0;a<n.length;a++){let e=n[a];if(this.blob){let t=new Blob([e],{type:e.type,name:e.name});o.push(t)}else o.push(e)}if(o.length>this.max)return this.$AF.$msg.error(`Bạn chỉ được chọn tối đa ${this.max} tệp`),0;this.resolve&&this.resolve(1===this.max?o[0]:o),this.file_picker.value=null}}};const Ye=(0,g.A)(Qe,[["render",He]]);var Ze=Ye;const et={class:"image-cropper"};function tt(e,t,i,n,a,s){return(0,o.uX)(),(0,o.CE)("div",et)}var it={name:"component__image-cropper",data(){return{}}};const nt=(0,g.A)(it,[["render",tt]]);var ot=nt;const at={class:"input-text-auto"},st=["id"],lt=["value"];function rt(e,t,i,a,s,l){return(0,o.uX)(),(0,o.CE)("div",at,[(0,o.bo)((0,o.Lk)("textarea",{id:s.el_id,rows:"1",onKeyup:t[0]||(t[0]=(...e)=>l.calculateHeight&&l.calculateHeight(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>s.scopeValue=e),onMouseup:t[2]||(t[2]=(...e)=>l.calculateHeight&&l.calculateHeight(...e))},null,40,st),[[n.Jo,s.scopeValue]]),(0,o.Lk)("textarea",{value:s.scopeValue,class:(0,b.C4)("fn__hidden_textarea fn_hide_"+s.el_id),rows:"1",tabindex:"-1"},null,10,lt)])}var dt={name:"component__input-text",props:{modelValue:{type:String,default:()=>"222"}},data(){return{scopeValue:"1",el_id:""}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){this.$emit("update:modelValue",e)}},beforeMount(){this.el_id=`input_text_${this.generateCode(24)}`,this.scopeValue=this.modelValue},mounted(){this.calculateHeight()},methods:{calculateHeight(){let e=this.jquery("#"+this.el_id),t=34,i=4,n=22,o=this.jquery(".fn_hide_"+this.el_id)[0],a=o.scrollHeight-t,s=Math.floor(a/n);e.css({height:s*n+t+i})}}};const ct=(0,g.A)(dt,[["render",rt]]);var ut=ct;const ht={class:"fn__toggle"},pt={class:"t_in"},gt=["disabled"];function mt(e,t,i,a,s,l){return(0,o.uX)(),(0,o.CE)("label",ht,[(0,o.Lk)("span",pt,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>s.scopeValue=e),disabled:i.disabled},null,8,gt),[[n.lH,s.scopeValue]]),t[1]||(t[1]=(0,o.Lk)("span",{class:"t_slider"},null,-1)),t[2]||(t[2]=(0,o.Lk)("span",{class:"t_content"},null,-1))]),(0,o.RG)(e.$slots,"default")])}var _t={name:"component__switch",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data(){return{scopeValue:!1}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){e!==this.modelValue&&this.$emit("update:modelValue",e)}},beforeMount(){this.scopeValue=this.modelValue}};const ft=(0,g.A)(_t,[["render",mt]]);var bt=ft;const vt={class:"all_models"};function yt(e,t,i,n,a,s){return(0,o.uX)(),(0,o.CE)("div",{class:(0,b.C4)({fn__select_model:!0,opened:a.is_open})},[(0,o.Lk)("a",{class:"model_open",onClick:t[0]||(t[0]=e=>s.handleTrigger("click")),onMouseover:t[1]||(t[1]=e=>s.handleTrigger("over"))},[(0,o.RG)(e.$slots,"ref")],32),(0,o.Lk)("div",vt,[(0,o.RG)(e.$slots,"default")])],2)}var wt={name:"component__popover",props:{trigger:{type:String,default:"click"}},data(){return{is_open:!1}},methods:{handleTrigger(e="click"){if(e!==this.trigger)return 0;this.is_open=!this.is_open}}};const kt=(0,g.A)(wt,[["render",yt]]);var xt=kt;const Lt=["id"],Ft=["value"];function Ct(e,t,i,a,s,l){return(0,o.bo)(((0,o.uX)(),(0,o.CE)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.scopeValue=e),id:s.id},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.options,e=>((0,o.uX)(),(0,o.CE)("option",{value:e[0]},(0,b.v_)(e[1]),9,Ft))),256))],8,Lt)),[[n.u1,s.scopeValue]])}var $t={name:"component__select-single",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]}},data(){return{scopeValue:"",id:""}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=!1)},scopeValue:function(e){e!==this.modelValue&&this.$emit("update:modelValue",e)}},beforeMount(){this.id=`select-single-${this.generateCode(24)}`,this.scopeValue=this.modelValue}};const At=(0,g.A)($t,[["render",Ct]]);var St=At;const Ut={href:"javascript:0;",class:"sidebar__trigger"};function Vt(e,t,i,n,a,s){const l=(0,o.g2)("Icon");return(0,o.uX)(),(0,o.CE)("a",Ut,[(0,o.bF)(l,{icon:"solar:settings-broken",height:"24"})])}var Et={name:"component__sidebar-page-trigger",components:{Icon:h.In},data(){return{}}};const Tt=(0,g.A)(Et,[["render",Vt]]);var jt=Tt;const It={class:"fn__range"},Pt={class:"range_in"},Ot=["min","max"],Rt={class:"value"};function Wt(e,t,i,a,s,l){return(0,o.uX)(),(0,o.CE)("div",It,[(0,o.Lk)("div",Pt,[(0,o.bo)((0,o.Lk)("input",{type:"range","onUpdate:modelValue":t[0]||(t[0]=e=>s.scopeValue=e),min:i.min,max:i.max},null,8,Ot),[[n.Jo,s.scopeValue]]),t[1]||(t[1]=(0,o.Lk)("div",{class:"slider"},null,-1))]),(0,o.Lk)("div",Rt,(0,b.v_)(s.scopeValue),1)])}var Dt={name:"component__slider",props:{modelValue:{type:Number,default:0},min:{type:Number,default:0},max:{type:Number,default:100}},data(){return{scopeValue:this.modelValue}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){e!==this.modelValue&&this.$emit("update:modelValue",e)}}};const Nt=(0,g.A)(Dt,[["render",Wt]]);var Xt=Nt;const Bt=["title"];function Jt(e,t,i,n,a,s){return(0,o.uX)(),(0,o.CE)("span",{class:"fn__tooltip",title:i.content},[(0,o.RG)(e.$slots,"default")],8,Bt)}var Mt={name:"component__tooltip",props:{content:{type:String,default:""}},data(){return{}}};const qt=(0,g.A)(Mt,[["render",Jt]]);var zt=qt,Gt=i(7110);const Kt=(0,n.Ef)(Xe);let Ht={base:new _({service_port:5e3}),server:new f({})};Kt.component("component__file-picker",Ze).component("component__image-cropper",ot).component("component__input-number",x).component("component__input-text",ut).component("component__switch",bt).component("component__popover",xt).component("component__select-single",St).component("component__sidebar-page-trigger",jt).component("component__slider",Xt).component("component__tooltip",zt).component("Icon",h.In),Kt.config.globalProperties.$fetch=Ht,Kt.config.globalProperties.jquery=ze(),Kt.config.globalProperties.timestamp=e=>Math.floor(new Date(e).getTime()/1e3),Kt.config.globalProperties.generateCode=e=>{let t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=i.length;for(let o=0;o<e;o++)t+=i.charAt(Math.floor(Math.random()*n));return t},Kt.config.globalProperties.sleep=e=>new Promise(t=>{setTimeout(()=>{t()},e)}),Kt.config.globalProperties.$AF=re,Kt.config.globalProperties.unbindObj=e=>JSON.parse(JSON.stringify(e)),Kt.config.globalProperties.overrideObj=(e,t)=>{let i=Kt.config.globalProperties.unbindObj(t);Object.keys(i).forEach(t=>{e[t]!==i[t]&&(e[t]=i[t])})},Kt.config.globalProperties.removeUnicode=e=>"undefined"===typeof e?"":(e=e.toString().toLowerCase(),e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),e=e.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),e=e.replace(/ì|í|ị|ỉ|ĩ/g,"i"),e=e.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),e=e.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),e=e.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),e=e.replace(/đ/g,"d"),e),Kt.config.globalProperties.srcCDN=ce,Kt.config.globalProperties.imageCDN=ce,Kt.config.globalProperties.INPUT_FILE_TYPE=ae,Kt.config.globalProperties.createMenuOptions=se,Kt.config.globalProperties.menuOptionsFunctions=ue,Kt.use(Me).use(ne).use(Gt.A).mount("#app")}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(t,n,o,a){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],o=e[c][1],a=e[c][2];for(var l=!0,r=0;r<n.length;r++)(!1&a||s>=a)&&Object.keys(i.O).every(function(e){return i.O[e](n[r])})?n.splice(r--,1):(l=!1,a<s&&(s=a));if(l){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,o,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,a,s=n[0],l=n[1],r=n[2],d=0;if(s.some(function(t){return 0!==e[t]})){for(o in l)i.o(l,o)&&(i.m[o]=l[o]);if(r)var c=r(i)}for(t&&t(n);d<s.length;d++)a=s[d],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(c)},n=self["webpackChunkphotobooth_client"]=self["webpackChunkphotobooth_client"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],function(){return i(8677)});n=i.O(n)})();